---
title: 进程和程序
tags: 操作系统
category: CS大学生必备
date: 2020/04/10 13:12
---

**进程：**一个具有一定独立功能的程序在一个数据集合上的一次动态执行的过程。

<!--more-->

<font size=4>

![4.png](https://i.loli.net/2020/05/05/Gh52Yn1yI6TSuWx.png)

## 进程包括什么

- 程序的代码；（需要放到内存中）
- 程序处理的数据；
- 程序计数器（PC），指令下一条将运行的指令；
- 通用寄存器的当前值，堆，栈；
- 系统资源（如打开的文件）

总之，进程包含了正在运行的一个程序的所有状态信息

## 程序和进程

单独来看程序和进程，它们的概念都非常的简单。粗略去看，程序是一个或多个文件，进程是操作系统上能做某些事情的东西。

更标准一点，程序是由编程人员编码好的一个或多个文件，换句话说，程序是由源代码组成的静态的文件，里面定义了这个程序要做什么事，实现什么功能。但是它仅仅只是定义了这些要做的事情以及要实现的功能，并没有去做这些事情。只有当程序在操作系统上运行起来之后产生了进程，才会由进程去做这些事情。所以，进程是程序在操作系统上运行之后产生的，是程序动起来之后的一个实例，因此也可以将进程看作是“运行中的程序”。

所以，程序自身只是包含了一些指令和一些静态数据，静止地躺在磁盘里的某个位置，它是无生命无灵魂的。当开始执行程序后，操作系统负责将程序源代码装载到内存中，使其动起来，赋予了它的灵魂和生命，它将因此变得有意义。

## 程序如何变成进程

静止的程序到底是怎么转换成运行的进程的？OS是如何让程序运行起来的？进程是如何创建并工作的？这是几个让人疑惑又想窥得究竟的问题。

OS要让磁盘上一个可执行格式（不是可执行权限）程序运行起来，第一件事就是（load）程序的相关代码以及静态数据（例如以初始化的变量）到内存中（具体的是到自己的虚拟内存地址空间）

早期一些操作系统，会一次性将程序所有相关代码和数据装载到内存，而现代的操作系统是lazy模式装载，只在程序的执行过程中需要某段代码时，临时去装载（虚拟内存）。

当代码和静态数据已经装载到内存后，OS还需要为将要运行的程序做一些额外的操作，比如为该进程分配一些内存；创建一些数据结构；初始化与IO相关的一些任务（比如Unix系统中，设置好每个进程都关联的3个文件描述符：stdout、stdin、stderr），等等。

当完成了这些操作后，程序开始执行。因为程序的执行要从main()函数（程序的入口，即使是非C程序，也一定有一个入口函数）开始，所以需要先跳转到main()函数，然后OS将CPU控制权交给新创建的进程，进程获取到CPU后就可以执行了。

## 进程和程序的联系

- 程序是产生进程的基础（进程的功能受限于程序中的代码）
- 程序的每次执行构成不同的进程（在内存中处理的数据不一样，获得的资源不一样，产生的行为可能不一样）
- 进程的执行过程是程序功能的体现
- 通过多次执行，一个程序可对应多个进程；多个程序可以组合在一起，形成一个大的进程

## 进程和程序的区别

- 进程是动态的，程序是静态的，程序是有序代码的集合，进程是程序的执进程有用户态/内核态
- 进程是暂时的，程序是永久的（保存在硬盘中）：进程是一个状态变化的过程，程序可长期保存
- 进程与程序的组成不同：进程的组成包括程序，数据和进程控制块（即进程状态信息）

## 进程创建的过程

1. 给新进程分配一个唯一的标识符
2. 给进程分配内存空间
3. 初始化进程控制块PCB
4. 将PCB放入就绪队列中，等待分配CPU资源

##  什么是进程控制块PCB

### 概念

​        PCB（progress control block），进程控制块。这里先不讨论PCB是什么，其实进程这个概念本身就是一个很难理解的概念，当一个可执行程序被系统执行了以后，就变成了一个进程。那么这个进程中到底有什么东西呢，系统究竟给这个进程分配了哪些资源？另外，进程在内存中的存储是怎么样的？
​        对于一个进程，它在被执行前其实是一个可执行程序。这个程序是被放在磁盘上的，当它要被执行的时候，它先被加载到内存当中，然后再放入到寄存器中，最后再让cpu执行该程序，这个时候一个静态的程序就变成了进程。
​        那么操作系统是怎么来管理这些进程的呢？操作系统通过一个**双向链表**把进程连起来。但是，对于进程其实它是一个抽象的概念，系统肯定要通过一个东西来描述进程，然后才能管理进程。于是PCB就出来了，操作系统通过PCB来描述进程，于是这个双向链表连接的其实是PCB，这个PCB是个什么玩意？它就是一个结构体，用来描述进程，在Linux下，就是task_struct结构体。

### 定义

- 1.是进程存在的唯一标识
- 2.创建一个进程就会创建一个PCB，当进程撤销时，系统回收它的PCB
- 3.系统对进程的控制根据PCB进行，对进程的管理通过管理PCB实现
- 4.能实现间断性的运行方式
- 5.提供进程间通信管理所需的资源
- 6.提供进程调度所需的信息

### PCB中保存的信息

- 1.进程的标识信息
- 2.进程的状态信息（就绪、运行、阻塞）
- 3.进程的控制信息